<!doctype html>
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script>
			/*
			 	You are given an array nums consisting of n prime integers.

        You need to construct an array ans of length n, such that, for each index i, 
        the bitwise OR of ans[i] and ans[i] + 1 is equal to nums[i], i.e. ans[i] OR 
        (ans[i] + 1) == nums[i].

        Additionally, you must minimize each value of ans[i] in the resulting array.

        If it is not possible to find such a value for ans[i] that satisfies the condition, 
        then set ans[i] = -1.
			 */
			$(document).ready(function(){
        
				/*
        * @param nums: a list of integers
        * @return: an array ans of length n
        */
        let findXSum = function(nums, k, x) {
            const n = nums.length;
            const result = [];
            const freq = new Map();

            // Initialize frequency map with first k elements
            for (let i = 0; i < k; i++) {
                freq.set(nums[i], (freq.get(nums[i]) || 0) + 1);
            }

            result.push(computeXSum(freq, x));

            for (let i = k; i < n; i++) {
                // Remove element going out of the window
                const out = nums[i - k];
                freq.set(out, freq.get(out) - 1);
                if (freq.get(out) === 0) {
                    freq.delete(out);
                }

                // Add element coming into the window
                const inVal = nums[i];
                freq.set(inVal, (freq.get(inVal) || 0) + 1);

                result.push(computeXSum(freq, x));
            }

            return result;
        };

        function computeXSum(freqMap, x) {
            const freqList = [];

            // Convert freqMap to list of [value, count]
            for (let [val, count] of freqMap.entries()) {
                freqList.push([val, count]);
            }

            // Sort by frequency DESC, then value DESC
            freqList.sort((a, b) => {
                if (b[1] !== a[1]) return b[1] - a[1];
                return b[0] - a[0];
            });

            // Select top x values
            const topX = new Set();
            for (let i = 0; i < Math.min(x, freqList.length); i++) {
                topX.add(freqList[i][0]);
            }

            // Sum up values from top x
            let sum = 0;
            for (let [val, count] of freqMap.entries()) {
                if (topX.has(val)) {
                    sum += val * count;
                }
            }

            return sum;
        }

        const input = [1,1,2,2,3,4,2,3];
        const k = 6, x = 2;
        let results = findXSum(input, k, x);
				$('#t1').html('<h2>Input: ' + JSON.stringify(input, null, 2) + '<br>Results: ' + JSON.stringify(results, null, 2) + '</h2>');
			});

			/*sol:
				For each num in the list:
        1. Try all possible x from 0 up to num.
        2. For each x, check: if (x | (x + 1)) == num
        3. If such an x is found, take the smallest one and break the loop.
        4. If no such x exists, set the answer to -1.
			 */

		</script>
	</head>
	
	<body>
		<div>
			<p id='t1'></p>
		</div>
	</body>

</html>